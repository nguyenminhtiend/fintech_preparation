// The Double-Entry Ledger
model LedgerEntry {
  id            String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  transactionId String? @map("transaction_id") @db.Uuid
  accountId     String? @map("account_id") @db.Uuid

  entryType String @map("entry_type") @db.VarChar(10) // 'DEBIT' or 'CREDIT'
  amount    BigInt

  balanceAfter BigInt?  @map("balance_after")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz

  transaction Transaction? @relation(fields: [transactionId], references: [id])
  account     Account?     @relation(fields: [accountId], references: [id])

  @@index([accountId, createdAt])
  @@index([transactionId])
  @@map("ledger_entries")
}
